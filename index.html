<!DOCTYPE html>

<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="style.css"></link> <!--stylesheet-->
    <script>
        function populateTable(data){ //populates our table object of choice with divs displaying weather reports
            $("#output").empty() //empty our output element first
            var businesses = data.businesses;

            report = "<ul style='padding:0; width:100%; list-style-type:none; text-align:center'>"
            for(i = 0; i < 5; i++){
                var name = businesses[i].name;
                var price = businesses[i].price;
                var image_url = businesses[i].image_url;
                var website = businesses[i].url;
                var address = businesses[i].location.display_address
                var report = report + "<li><b>" + name + "</b><br>" + price + "<br>"+ address +"<br> <a href = " + website +"><img style='width:25%; height:25%' src=" + image_url + "></img></a></li><hr>";
            }
            report += "</ul>"
            $("#output").append(report);
        }
        function getDonuts(){
            var url = window.location + "donuts" + "?term=" + document.getElementById("term").value;
			url += "&zip="; 
			url += document.getElementById("zip").value;
            $.ajax({type: "GET", url: url, dataType: "json",
                success: function(data){
                    populateTable(data);
                },
                error: function(xhr, ajaxOptions, thrownError){
                    alert("Could not locate resource");
                }
            });
        }
        function getCookie(){
            var url = window.location + "cookie";
            alert(url);
            $.ajax({type: "GET", url: url, credentials: "include",
                success: function(data){
                    alert(document.cookie);
                },
                error: function(xhr, ajaxOptions, thrownError){
                    alert("Could not fetch cookie");
                }
            });
        }
        $(document).ready(function(){
            $("#request").click(function(){ //on this button click, invoke our functions and display the reports
                getDonuts();
                //.hide().appendTo("#output").fadeIn();
            });
            getCookie();

        });
    </script>

    <title>Find Donuts Now</title>
</head>

<body>
    <div data-role="header" class="header"><h1>Donut.me</h1></div>
	<center>
	<input type="text" placeholder="What are you looking for?" id="term"><br><input type="text" placeholder="Your zip code" id="zip"><br>
    <button id="request">Yum</button>
	<br><br>
    <div id="output">
    </div></center>
    <div data-role="footer" class="header"><h1>CS275</h1></div>
</body>
</html>
